<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emotion Analysis Tool</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .result-section {
            margin-top: 20px;
            padding: 15px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: #f9f9f9;
        }
    </style>
</head>
<body>

    <h1>Emotion Analysis Tool</h1>
    
    <label for="primary-emotion">Primary Emotion:</label>
    <select id="primary-emotion"></select>

    <label for="secondary-emotion">Secondary Emotion:</label>
    <select id="secondary-emotion"></select>

    <label for="tertiary-emotion">Tertiary Emotion:</label>
    <select id="tertiary-emotion"></select>

    <label for="influence">Influence:</label>
    <select id="influence"></select>

    <button id="check-button">Check</button>

    <div id="result" class="result-section" style="display: none;">
        <h2>Analysis:</h2>
        <div id="clarify-emotion"></div>
        <div id="explore-influence"></div>
        <div id="insights-guidance"></div>
    </div>

    <script>
        const jsonUrl = 'path/to/your/structured_new.json'; // Replace with actual URL
        let data = [];

        // Fetch JSON data
        fetch(jsonUrl)
            .then(response => response.json())
            .then(jsonData => {
                data = jsonData;
                populateDropdowns();
            })
            .catch(error => console.error('Error loading JSON:', error));

        function populateDropdowns() {
            const primaryEmotionSet = new Set();
            const influenceSet = new Set();

            data.forEach(item => {
                primaryEmotionSet.add(item.primary_emotion);
                influenceSet.add(item.influence);
            });

            populateDropdown('primary-emotion', Array.from(primaryEmotionSet));
            populateDropdown('influence', Array.from(influenceSet));

            document.getElementById('primary-emotion').addEventListener('change', onPrimaryChange);
        }

        function populateDropdown(dropdownId, options) {
            const dropdown = document.getElementById(dropdownId);
            dropdown.innerHTML = '<option value="">Select...</option>';
            options.forEach(option => {
                const opt = document.createElement('option');
                opt.value = option;
                opt.textContent = option;
                dropdown.appendChild(opt);
            });
        }

        function onPrimaryChange() {
            const selectedPrimary = document.getElementById('primary-emotion').value;
            const secondaryEmotionSet = new Set();

            data.forEach(item => {
                if (item.primary_emotion === selectedPrimary) {
                    secondaryEmotionSet.add(item.secondary_emotion);
                }
            });

            populateDropdown('secondary-emotion', Array.from(secondaryEmotionSet));
            document.getElementById('secondary-emotion').addEventListener('change', onSecondaryChange);
        }

        function onSecondaryChange() {
            const selectedPrimary = document.getElementById('primary-emotion').value;
            const selectedSecondary = document.getElementById('secondary-emotion').value;
            const tertiaryEmotionSet = new Set();

            data.forEach(item => {
                if (item.primary_emotion === selectedPrimary && item.secondary_emotion === selectedSecondary) {
                    tertiaryEmotionSet.add(item.tertiary_emotion);
                }
            });

            populateDropdown('tertiary-emotion', Array.from(tertiaryEmotionSet));
        }

        document.getElementById('check-button').addEventListener('click', () => {
            const selectedPrimary = document.getElementById('primary-emotion').value;
            const selectedSecondary = document.getElementById('secondary-emotion').value;
            const selectedTertiary = document.getElementById('tertiary-emotion').value;
            const selectedInfluence = document.getElementById('influence').value;

            const result = data.find(item =>
                item.primary_emotion === selectedPrimary &&
                item.secondary_emotion === selectedSecondary &&
                item.tertiary_emotion === selectedTertiary &&
                item.influence === selectedInfluence
            );

            if (result) {
                displayResult(result.analysis);
            } else {
                document.getElementById('result').style.display = 'none';
                alert('No matching analysis found.');
            }
        });

        function displayResult(analysis) {
            document.getElementById('clarify-emotion').innerHTML = `<strong>Clarify the Emotion:</strong><br>${analysis.clarify_emotion.replace(/\n/g, '<br>')}`;
            document.getElementById('explore-influence').innerHTML = `<strong>Explore the Influence:</strong><br>${analysis.explore_influence.replace(/\n/g, '<br>')}`;
            document.getElementById('insights-guidance').innerHTML = `<strong>Insights and Guidance:</strong><br>${analysis.insights_guidance.join('<br>')}`;
            document.getElementById('result').style.display = 'block';
        }
    </script>

</body>
</html>
